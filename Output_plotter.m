%% Data analysis of openFAST outputs
close all
%16st tester with 15-240-RWT-Monopile

% 5 minute sim#
A = importdata('5MW_OC3Mnpl_DLL_WTurb_WavesIrr.out'); %this might take 5 mins lol
 %IEA-15-240-RWT-Monopile.out' 
 %imported columns = A6:AAZ120009 (get 1:24? - A - (64 = BN)
 % Also want 64 and 65 - BM-BN 
 % And want 883 - 
 
t = A.data(:,1);
% A = IEA15240RWTMonopile;
% A = A
%2-4 = wind speeds (x,y,z)
v_x = A.data(:,2);
% 5 = azimuth  
Azimuth = A.data(:,5);

% 6-8 = blade pitch angles
Pitch_1 = A.data(:,6);

% 18 = Nacelle Ys (fore aft acceleration)(uses shaft coords)
Nac_4aft_acc = A.data(:,18);

% 24 = surge? (platform surge)
Surge = A.data(:,24);

% 64 = rotor speed! (rpm)
Rt_speed = A.data(:,64);

% 65 = rotor thrust!
Rt_thrst = A.data(:,65);

% 66 = rotor torque
Rt_Torq = A.data(:,66);

% 119 = Foreaft Displacement (Tower Top) (turbine coords!!)
Top_4aft_disp = A.data(:,21);
%or 119
% 300 ish

Cp = A.data(:,278);

Ct = A.data(:,279);


Rt_sp = A.data(:,281);


TSR = A.data(:,282);

Cq = Cp./TSR;

%Relative Wind speed
v_w_eff = A.data(:,277);

%Rotor Area
Area = A.data(:,280);

% 883 = power produced?
P = A.data(:,883);

% 884 = Torque generated
Gen_Torq = A.data(:,884);

% Approx aero torq and thrust
rho = 1.22521;
R = 120;

F_aero = 0.5*rho*Area.*v_w_eff.^2.*Ct/1000;
Tau_aero = 0.5*rho*Area.*R.*v_w_eff.^2.*Cq/1000;

FAST = [Pitch_1,TSR,Rt_speed,F_aero,Tau_aero,Cq,Ct,Top_4aft_disp,v_w_eff]';

% Meshes for coefficients

Ct_1 = [0.069339   0.069285   0.069265   0.069284   0.069348   0.069462   0.069631   0.069861   0.070156   0.070515   0.070940   0.071427   0.071969   0.072555   0.073167   0.073784   0.074381   0.074929   0.075399   0.075762   0.075989   0.076053   0.075927   0.075585   0.075002   0.074156   0.073033   0.071627   0.069936   0.067961   0.065707   0.063182   0.060399   0.057373   0.054125   0.050677 ;  
0.091816   0.092396   0.093076   0.093861   0.094755   0.095757   0.096861   0.098053   0.099312   0.100607   0.101899   0.103144   0.104293   0.105296   0.106103   0.106664   0.106932   0.106859   0.106400   0.105518   0.104185   0.102388   0.100122   0.097389   0.094199   0.090571   0.086535   0.082128   0.077386   0.072348   0.067046   0.061514   0.055786   0.049889   0.043854   0.037706   ;
0.123474   0.125175   0.127037   0.129041   0.131158   0.133343   0.135537   0.137673   0.139677   0.141468   0.142968   0.144098   0.144778   0.144928   0.144475   0.143363   0.141549   0.139013   0.135746   0.131760   0.127085   0.121773   0.115886   0.109490   0.102647   0.095413   0.087844   0.079990   0.071896   0.063601   0.055138   0.046541   0.037842   0.029084   0.020313   0.011584   ;
0.165573   0.168765   0.172067   0.175395   0.178652   0.181729   0.184510   0.186878   0.188712   0.189886   0.190280   0.189783   0.188309   0.185796   0.182213   0.177561   0.171880   0.165246   0.157753   0.149506   0.140602   0.131135   0.121193   0.110856   0.100191   0.089257   0.078096   0.066745   0.055241   0.043622   0.031934   0.020232   0.008586   -0.002925   -0.014205   -0.025150   ;
0.218578   0.223272   0.227828   0.232089   0.235890   0.239062   0.241423   0.242792   0.242998   0.241890   0.239359   0.235341   0.229830   0.222880   0.214602   0.205136   0.194628   0.183227   0.171072   0.158293   0.145007   0.131310   0.117282   0.102979   0.088445   0.073715   0.058829   0.043826   0.028760   0.013705   -0.001248   -0.015985   -0.030377   -0.044284   -0.057563   -0.070069   ;
0.282170   0.287984   0.293205   0.297595   0.300902   0.302869   0.303257   0.301860   0.298532   0.293212   0.285926   0.276781   0.265950   0.253634   0.240038   0.225364   0.209800   0.193518   0.176663   0.159356   0.141688   0.123724   0.105508   0.087076   0.068461   0.049704   0.030866   0.012031   -0.006687   -0.025154   -0.043209   -0.060678   -0.077376   -0.093114   -0.107708   -0.120989   ;
0.355551   0.361717   0.366570   0.369761   0.370962   0.369889   0.366343   0.360246   0.351638   0.340662   0.327543   0.312549   0.295952   0.278014   0.258980   0.239067   0.218462   0.197319   0.175758   0.153858   0.131672   0.109234   0.086576   0.063737   0.040774   0.017772   -0.005152   -0.027850   -0.050141   -0.071820   -0.092665   -0.112437   -0.130896   -0.147809   -0.162979   -0.176255   ;
0.437424   0.442600   0.445428   0.445527   0.442621   0.436568   0.427391   0.415241   0.400373   0.383119   0.363825   0.342820   0.320406   0.296858   0.272415   0.247283   0.221625   0.195556   0.169146   0.142442   0.115476   0.088285   0.060910   0.033423   0.005927   -0.021432   -0.048470   -0.074961   -0.100651   -0.125266   -0.148509   -0.170083   -0.189704   -0.207135   -0.222205   -0.234819   ;
0.525460   0.527667   0.526388   0.521407   0.512676   0.500320   0.484572   0.465789   0.444390   0.420775   0.395313   0.368336   0.340148   0.311014   0.281163   0.250768   0.219948   0.188774   0.157288   0.125523   0.093512   0.061304   0.028977   -0.003353   -0.035515   -0.067288   -0.098400   -0.128550   -0.157409   -0.184625   -0.209836   -0.232697   -0.252917   -0.270290   -0.284715   -0.296179   ;
0.615952   0.613062   0.605901   0.594509   0.579067   0.559868   0.537340   0.511939   0.484103   0.454230   0.422681   0.389789   0.355853   0.321130   0.285821   0.250056   0.213904   0.177405   0.140589   0.103492   0.066167   0.028691   -0.008807   -0.046142   -0.083058   -0.119241   -0.154343   -0.187982   -0.219751   -0.249221   -0.275974   -0.299648   -0.319983   -0.336843   -0.350215   -0.360169   ;
0.704449   0.694964   0.681074   0.662912   0.640727   0.614890   0.585866   0.554109   0.520036   0.484043   0.446498   0.407746   0.368089   0.327760   0.286907   0.245605   0.203892   0.161803   0.119377   0.076670   0.033761   -0.009223   -0.052085   -0.094547   -0.136257   -0.176821   -0.215808   -0.252755   -0.287172   -0.318563   -0.346472   -0.370554   -0.390616   -0.406617   -0.418630   -0.426816   ;
0.788050   0.771081   0.750180   0.725566   0.697249   0.665444   0.630464   0.592722   0.552663   0.510720   0.467303   0.422770   0.377405   0.331392   0.284823   0.237745   0.190200   0.142234   0.093911   0.045313   -0.003438   -0.052150   -0.100535   -0.148212   -0.194742   -0.239647   -0.282414   -0.322495   -0.359318   -0.392326   -0.421055   -0.445212   -0.464702   -0.479579   -0.490008   -0.496248   ;
0.865515   0.840957   0.813170   0.782370   0.748642   0.711681   0.671434   0.628192   0.582472   0.534801   0.485644   0.435368   0.384230   0.332362   0.279836   0.226708   0.173041   0.118910   0.064405   0.009644   -0.045195   -0.099832   -0.153874   -0.206843   -0.258215   -0.307428   -0.353882   -0.396940   -0.435949   -0.470305   -0.499570   -0.523541   -0.542228   -0.555781   -0.564463   -0.568631   ;
0.936624   0.904628   0.870386   0.834093   0.795408   0.753900   0.709091   0.660970   0.609969   0.556782   0.501963   0.445906   0.388839   0.330884   0.272133   0.212671   0.152595   0.092013   0.031045   -0.030145   -0.091302   -0.152046   -0.211872   -0.270212   -0.326456   -0.379954   -0.430018   -0.475915   -0.516910   -0.552380   -0.581950   -0.605533   -0.623237   -0.635315   -0.642129   -0.644126   ;
1.003783   0.963890   0.923043   0.881412   0.838282   0.792686   0.743893   0.691437   0.635555   0.577025   0.516565   0.454614   0.391411   0.327117   0.261867   0.195788   0.129019   0.061701   -0.006008   -0.073887   -0.141587   -0.208610   -0.274348   -0.338143   -0.399299   -0.457078   -0.510691   -0.559303   -0.602106   -0.638490   -0.668186   -0.691219   -0.707803   -0.718289   -0.723134   -0.722877   ;
1.069660   1.021807   0.973433   0.925583   0.877961   0.828685   0.776187   0.719857   0.659500   0.595781   0.529650   0.461644   0.392082   0.321193   0.249169   0.176195   0.102450   0.028111   -0.046621   -0.121447   -0.195907   -0.269379   -0.341162   -0.410508   -0.476633   -0.538701   -0.595814   -0.647027   -0.691478   -0.728616   -0.758297   -0.780656   -0.796011   -0.804806   -0.807593   -0.805005   ;
1.135151   1.079519   1.023640   0.968618   0.915361   0.862272   0.806463   0.746481   0.681967   0.613212   0.541346   0.467113   0.390965   0.313224   0.234158   0.154010   0.073002   -0.008650   -0.090686   -0.172715   -0.254145   -0.334241   -0.412210   -0.487216   -0.558380   -0.624756   -0.685326   -0.739035   -0.785001   -0.822768   -0.852322   -0.873908   -0.887939   -0.894954   -0.895600   -0.890608   ;
1.200634   1.137445   1.074091   1.011838   0.951774   0.894037   0.834912   0.771492   0.703048   0.629422   0.551751   0.471121   0.388161   0.303315   0.216936   0.129330   0.040767   -0.048492   -0.138117   -0.227598   -0.316208   -0.403110   -0.487418   -0.568205   -0.644486   -0.715195   -0.779185   -0.835299   -0.882669   -0.920969   -0.950309   -0.971037   -0.983660   -0.988810   -0.987235   -0.979770   ;
1.265255   1.195691   1.124977   1.055449   0.988373   0.924624   0.861796   0.795127   0.722837   0.644478   0.560948   0.473752   0.383758   0.291553   0.197588   0.102236   0.005819   -0.091347   -0.188842   -0.286020   -0.382025   -0.475922   -0.566734   -0.653432   -0.734914   -0.809987   -0.877364   -0.935804   -0.984492   -1.023251   -1.052305   -1.072100   -1.083234   -1.086438   -1.082566   -1.072555   ;
1.328343   1.253526   1.176341   1.099544   1.025366   0.954961   0.887436   0.817466   0.741390   0.658428   0.569007   0.475083   0.377831   0.278012   0.176184   0.072792   -0.031782   -0.137156   -0.242799   -0.347918   -0.451540   -0.552633   -0.650122   -0.742865   -0.829637   -0.909108   -0.979846   -1.040544   -1.090488   -1.129647   -1.158354   -1.177145   -1.186712   -1.187891   -1.181646   -1.169016   ;
1.389243   1.310229   1.227774   1.144163   1.062812   0.985517   0.912297   0.838613   0.758818   0.671306   0.575987   0.475177   0.370448   0.262756   0.152781   0.041050   -0.071988   -0.185871   -0.299938   -0.413247   -0.524713   -0.633211   -0.737554   -0.836483   -0.928639   -1.012543   -1.086618   -1.149524   -1.200679   -1.240192   -1.268496   -1.286214   -1.294139   -1.293215   -1.284523   -1.269193   ;
1.446495   1.365446   1.278456   1.189187   1.100736   1.016407   0.936851   0.858699   0.775201   0.683140   0.581940   0.474094   0.361664   0.245836   0.127425   0.007052   -0.114760   -0.237453   -0.360218   -0.481968   -0.601517   -0.717631   -0.829012   -0.934270   -1.031906   -1.120281   -1.197677   -1.262753   -1.315088   -1.354917   -1.382763   -1.399343   -1.405550   -1.402447   -1.391234   -1.373118   ;
1.500721   1.417864   1.328236   1.234040   1.139124   1.047650   0.961392   0.877983   0.790575   0.693978   0.586914   0.471885   0.351528   0.227296   0.100156   -0.029167   -0.160066   -0.291867   -0.423604   -0.554054   -0.681927   -0.805878   -0.924482   -1.036215   -1.139429   -1.232316   -1.313020   -1.380245   -1.433740   -1.473850   -1.501186   -1.516561   -1.520978   -1.515620   -1.501808   -1.480814   ;
1.551807   1.467724   1.376212   1.278271   1.177831   1.079246   0.986033   0.896750   0.805016   0.703846   0.590948   0.468593   0.340079   0.207169   0.071004   -0.067579   -0.207877   -0.349086   -0.490070   -0.629485   -0.765930   -0.897937   -1.023953   -1.142311   -1.251201   -1.348641   -1.432649   -1.502015   -1.556654   -1.597013   -1.623789   -1.637895   -1.640449   -1.632760   -1.616272   -1.592298   ;
1.598372   1.515229   1.421950   1.321664   1.216399   1.111177   1.010820   0.915192   0.818588   0.712807   0.594079   0.464255   0.327350   0.185486   0.039995   -0.108161   -0.258171   -0.409083   -0.559596   -0.708245   -0.853511   -0.993800   -1.127420   -1.252552   -1.367219   -1.469253   -1.556568   -1.628077   -1.683852   -1.724429   -1.750594   -1.763367   -1.763986   -1.753891   -1.734646   -1.707584   ;
1.639737   1.559431   1.465833   1.363446   1.254467   1.143376   1.035772   0.933446   0.831408   0.720912   0.596337   0.458902   0.313369   0.162271   0.007152   -0.150891   -0.310927   -0.471838   -0.632165   -0.790322   -0.944662   -1.093459   -1.234875   -1.366933   -1.487477   -1.594151   -1.684783   -1.758447   -1.815350   -1.856114   -1.881620   -1.892996   -1.891607   -1.879032   -1.856946   -1.826682   ];


%Torque coefficient

Cq_1 = [0.003634   0.004694   0.005780   0.006894   0.008035   0.009203   0.010397   0.011614   0.012851   0.014104   0.015368   0.016639   0.017911   0.019175   0.020423   0.021646   0.022831   0.023963   0.025029   0.026012   0.026897   0.027668   0.028311   0.028812   0.029157   0.029337   0.029344   0.029176   0.028831   0.028311   0.027622   0.026768   0.025757   0.024600   0.023309   0.021894;
0.007794   0.009410   0.011053   0.012717   0.014396   0.016082   0.017769   0.019449   0.021113   0.022750   0.024347   0.025886   0.027348   0.028712   0.029957   0.031062   0.032007   0.032770   0.033335   0.033685   0.033812   0.033710   0.033377   0.032816   0.032034   0.031042   0.029855   0.028489   0.026962   0.025291   0.023490   0.021574   0.019556   0.017446   0.015255   0.012992   ;
0.013658   0.015833   0.018004   0.020161   0.022296   0.024396   0.026444   0.028419   0.030296   0.032048   0.033649   0.035069   0.036282   0.037261   0.037982   0.038427   0.038584   0.038444   0.038008   0.037283   0.036283   0.035029   0.033546   0.031859   0.029993   0.027968   0.025806   0.023523   0.021134   0.018649   0.016078   0.013429   0.010710   0.007932   0.005108   0.002252   ;
0.020599   0.023263   0.025880   0.028430   0.030887   0.033221   0.035397   0.037382   0.039141   0.040637   0.041838   0.042715   0.043244   0.043408   0.043201   0.042626   0.041701   0.040450   0.038906   0.037103   0.035075   0.032852   0.030463   0.027930   0.025275   0.022511   0.019649   0.016694   0.013655   0.010537   0.007348   0.004100   0.000809   -0.002505   -0.005817   -0.009097 ;  
0.028121   0.031183   0.034115   0.036878   0.039432   0.041733   0.043739   0.045407   0.046698   0.047579   0.048025   0.048021   0.047572   0.046696   0.045425   0.043798   0.041860   0.039652   0.037214   0.034582   0.031788   0.028856   0.025804   0.022645   0.019383   0.016025   0.012572   0.009029   0.005403   0.001706   -0.002043   -0.005818   -0.009588   -0.013317   -0.016968   -0.020502;   
0.035808   0.039103   0.042145   0.044885   0.047271   0.049253   0.050785   0.051828   0.052353   0.052353   0.051838   0.050837   0.049391   0.047552   0.045369   0.042892   0.040168   0.037238   0.034137   0.030892   0.027523   0.024038   0.020444   0.016740   0.012926   0.009004   0.004978   0.000861   -0.003329   -0.007565   -0.011811   -0.016027   -0.020170   -0.024192   -0.028047   -0.031691;   
0.043207   0.046521   0.049436   0.051896   0.053846   0.055239   0.056044   0.056254   0.055882   0.054960   0.053533   0.051660   0.049396   0.046798   0.043917   0.040801   0.037490   0.034017   0.030406   0.026669   0.022808   0.018824   0.014713   0.010473   0.006104   0.001615   -0.002979   -0.007653   -0.012372   -0.017094   -0.021770   -0.026347   -0.030768   -0.034978   -0.038928   -0.042580;   
0.049832   0.052926   0.055468   0.057408   0.058708   0.059353   0.059355   0.058740   0.057553   0.055853   0.053701   0.051156   0.048272   0.045104   0.041699   0.038098   0.034333   0.030423   0.026373   0.022184   0.017851   0.013368   0.008733   0.003944   -0.000988   -0.006046   -0.011199   -0.016407   -0.021619   -0.026779   -0.031824   -0.036688   -0.041307   -0.045625   -0.049601   -0.053212;   
0.055124   0.057778   0.059766   0.061067   0.061681   0.061626   0.060933   0.059653   0.057846   0.055571   0.052885   0.049842   0.046496   0.042899   0.039092   0.035107   0.030960   0.026654   0.022186   0.017550   0.012737   0.007742   0.002564   -0.002788   -0.008295   -0.013922   -0.019623   -0.025342   -0.031014   -0.036568   -0.041928   -0.047020   -0.051780   -0.056161   -0.060136   -0.063701;   
0.058437   0.060583   0.062040   0.062806   0.062893   0.062328   0.061157   0.059431   0.057204   0.054528   0.051460   0.048055   0.044367   0.040442   0.036313   0.031998   0.027497   0.022807   0.017917   0.012819   0.007507   0.001976   -0.003765   -0.009699   -0.015788   -0.021982   -0.028219   -0.034428   -0.040530   -0.046441   -0.052075   -0.057357   -0.062229   -0.066659   -0.070641   -0.074184;   
0.059307   0.061097   0.062257   0.062760   0.062605   0.061803   0.060393   0.058421   0.055939   0.053005   0.049677   0.046016   0.042073   0.037888   0.033482   0.028857   0.024006   0.018921   0.013592   0.008011   0.002174   -0.003918   -0.010246   -0.016774   -0.023450   -0.030208   -0.036970   -0.043653   -0.050164   -0.056406   -0.062290   -0.067742   -0.072720   -0.077210   -0.081222   -0.084784;   
0.057940   0.059533   0.060629   0.061184   0.061098   0.060336   0.058910   0.056866   0.054271   0.051195   0.047706   0.043869   0.039734   0.035328   0.030659   0.025721   0.020508   0.015010   0.009219   0.003128   -0.003262   -0.009939   -0.016872   -0.024006   -0.031274   -0.038594   -0.045877   -0.053024   -0.059929   -0.066488   -0.072608   -0.078228   -0.083324   -0.087899   -0.091979   -0.095611;   
0.054668   0.056365   0.057647   0.058424   0.058629   0.058140   0.056899   0.054942   0.052357   0.049236   0.045664   0.041709   0.037415   0.032799   0.027862   0.022599   0.017005   0.011072   0.004794   -0.001833   -0.008803   -0.016089   -0.023642   -0.031393   -0.039258   -0.047144   -0.054947   -0.062555   -0.069849   -0.076717   -0.083073   -0.088873   -0.094109   -0.098802   -0.102995   -0.106751;   
0.050014   0.051996   0.053638   0.054848   0.055472   0.055392   0.054499   0.052776   0.050306   0.047219   0.043620   0.039581   0.035140   0.030310   0.025095   0.019491   0.013496   0.007104   0.000312   -0.006879   -0.014454   -0.022369   -0.030559   -0.038938   -0.047410   -0.055869   -0.064197   -0.072267   -0.079948   -0.087126   -0.093728   -0.099727   -0.105133   -0.109984   -0.114338   -0.118276 ;  
0.044912   0.047039   0.049010   0.050692   0.051846   0.052267   0.051826   0.050448   0.048188   0.045198   0.041610   0.037504   0.032915   0.027863   0.022354   0.016391   0.009974   0.003099   -0.004233   -0.012016   -0.020219   -0.028784   -0.037626   -0.046648   -0.055741   -0.064784   -0.073644   -0.082180   -0.090252   -0.097749   -0.104613   -0.110837   -0.116447   -0.121497   -0.126061   -0.130236 ;  
0.039957   0.042208   0.044279   0.046234   0.047905   0.048899   0.048959   0.048010   0.046043   0.043200   0.039648   0.035479   0.030738   0.025452   0.019635   0.013293   0.006431   -0.000951   -0.008850   -0.017250   -0.026106   -0.035339   -0.044851   -0.054533   -0.064262   -0.073902   -0.083305   -0.092316   -0.100786   -0.108615   -0.115764   -0.122242   -0.128094   -0.133385   -0.138206   -0.142674 ;  
0.035121   0.037569   0.039790   0.041850   0.043817   0.045357   0.045987   0.045503   0.043889   0.041237   0.037737   0.033505   0.028604   0.023072   0.016930   0.010191   0.002863   -0.005052   -0.013546   -0.022590   -0.032119   -0.042041   -0.052244   -0.062604   -0.072985   -0.083238   -0.093197   -0.102691   -0.111572   -0.119751   -0.127211   -0.133977   -0.140106   -0.145681   -0.150804   -0.155622  ; 
0.030378   0.033065   0.035493   0.037711   0.039800   0.041742   0.042937   0.042957   0.041737   0.039312   0.035873   0.031576   0.026507   0.020716   0.014233   0.007078   -0.000740   -0.009214   -0.018329   -0.028040   -0.038266   -0.048898   -0.059811   -0.070871   -0.081925   -0.092806   -0.103335   -0.113324   -0.122630   -0.131182   -0.138981   -0.146067   -0.152512   -0.158410   -0.163881   -0.169105  ; 
0.025774   0.028669   0.031342   0.033767   0.036012   0.038154   0.039850   0.040403   0.039593   0.037420   0.034051   0.029688   0.024442   0.018379   0.011539   0.003946   -0.004385   -0.013444   -0.023205   -0.033608   -0.044553   -0.055917   -0.067564   -0.079344   -0.091090   -0.102619   -0.113730   -0.124230   -0.133978   -0.142929   -0.151097   -0.158536   -0.165332   -0.171593   -0.177456   -0.183144   ;
0.021344   0.024412   0.027307   0.029977   0.032422   0.034723   0.036771   0.037845   0.037456   0.035558   0.032267   0.027835   0.022403   0.016055   0.008840   0.000790   -0.008078   -0.017748   -0.028181   -0.039300   -0.050985   -0.063105   -0.075510   -0.088033   -0.100492   -0.112686   -0.124396   -0.135421   -0.145635   -0.155010   -0.163576   -0.171402   -0.178584   -0.185246   -0.191544   -0.197756   ;
0.017123   0.020324   0.023397   0.026312   0.028993   0.031479   0.033761   0.035294   0.035335   0.033720   0.030517   0.026012   0.020385   0.013738   0.006131   -0.002398   -0.011827   -0.022132   -0.033263   -0.045119   -0.057571   -0.070471   -0.083656   -0.096946   -0.110140   -0.123017   -0.135343   -0.146911   -0.157613   -0.167440   -0.176435   -0.184679   -0.192282   -0.199382   -0.206158   -0.212958   ;
0.013196   0.016417   0.019646   0.022760   0.025697   0.028398   0.030871   0.032760   0.033231   0.031901   0.028795   0.024215   0.018383   0.011423   0.003406   -0.005623   -0.015637   -0.026603   -0.038454   -0.051072   -0.064314   -0.078019   -0.092011   -0.106090   -0.120040   -0.133620   -0.146579   -0.158710   -0.169925   -0.180232   -0.189686   -0.198379   -0.206436   -0.214011   -0.221308   -0.228760   ;
0.009516   0.012762   0.016048   0.019338   0.022512   0.025450   0.028116   0.030272   0.031141   0.030101   0.027099   0.022439   0.016393   0.009105   0.000660   -0.008890   -0.019513   -0.031165   -0.043760   -0.057164   -0.071221   -0.085757   -0.100579   -0.115473   -0.130201   -0.144504   -0.158113   -0.170828   -0.182583   -0.193397   -0.203338   -0.212512   -0.221057   -0.229141   -0.237004   -0.245175   ;
0.006083   0.009335   0.012648   0.016056   0.019426   0.022614   0.025483   0.027855   0.029069   0.028315   0.025423   0.020679   0.014408   0.006778   -0.002113   -0.012206   -0.023461   -0.035823   -0.049185   -0.063399   -0.078297   -0.093690   -0.109368   -0.125099   -0.140628   -0.155673   -0.169953   -0.183275   -0.195595   -0.206944   -0.217401   -0.227085   -0.236150   -0.244780   -0.253252   -0.262210   ;
0.002978   0.006111   0.009458   0.012912   0.016451   0.019870   0.022956   0.025519   0.027016   0.026545   0.023765   0.018933   0.012426   0.004439   -0.004916   -0.015573   -0.027484   -0.040579   -0.054732   -0.069782   -0.085546   -0.101821   -0.118381   -0.134975   -0.151327   -0.167135   -0.182104   -0.196058   -0.208968   -0.220879   -0.231881   -0.242106   -0.251722   -0.260932   -0.270059   -0.279873   ;
0.000235   0.003142   0.006445   0.009942   0.013591   0.017208   0.020518   0.023265   0.024989   0.024788   0.022121   0.017197   0.010443   0.002083   -0.007755   -0.018997   -0.031586   -0.045437   -0.060405   -0.076316   -0.092973   -0.110157   -0.127624   -0.145104   -0.162302   -0.178893   -0.194573   -0.209183   -0.222711   -0.235211   -0.246785   -0.257580   -0.267779   -0.277603   -0.287431   -0.298170]  ;






Pitch_m = [-5.0   -4.0   -3.0   -2.0   -1.0   0.0   1.0   2.0   3.0   4.0   5.0   6.0   7.0   8.0   9.0   10.0   11.0   12.0   13.0   14.0   15.0   16.0   17.0   18.0   19.0   20.0   21.0   22.0   23.0   24.0   25.0   26.0   27.0   28.0   29.0   30.0];


TSR_m = [2.0    2.5    3.0    3.5    4.0    4.5    5.0    5.5    6.0    6.5    7.0    7.5    8.0    8.5    9.0    9.5    10.0    10.5    11.0    11.5    12.0    12.5    13.0    13.5    14.0    14.5 ];

[Pitch_m,TSR_m] = meshgrid(Pitch_m,TSR_m);


% Plot power output and wind speed
plot(t,P/1000)
hold on
plot(t,v_x)
legend('Power Output (MW)','Wind Speed (m/s)')
xlabel('Time (s)')
ylabel('Power Output (MW) and Wind Speed (m/s)')

% Plot rotor speed and thrust
figure
plot(t,Rt_speed)
hold on
plot(t,Rt_thrst/1000)
legend('Rotor Speed (rpm)','Rotor Thrust (MN)')
xlabel('Time (s)')
ylabel('Rotor Speed (rpm),Rotor Thrust (MN)')

%Plot pitch angle and rotor speed
figure
plot(t,Pitch_1)
hold on
plot(t,Rt_speed)
legend('Blade Pitch (deg)','Rotor Speed (rpm)')
xlabel('Time (s)')
ylabel('Blade Pitch (deg) and Rotor Speed (rpm)')
ylim([0 95])

% plot Foreaft acceleratio and rotor thrust
figure
% plot(t,Rt_Torq)
% hold on
% plot(t,Tau_aero)
hold on
plot(t,F_aero)
hold on
plot(t,Rt_thrst)
%'Rotor Torque','Tau_aero'
legend('F_aero','Rotor Thrust')
xlabel('Time (s)')
ylabel('Rotor Torque (MNm) and Rotor Thrust (MN)')

% plot foreaft displacement to wind speed!
figure
plot(t,Top_4aft_disp)
hold on
plot(t,v_w_eff/10)
legend('Tower Top fore-aft displacement','Wind Speed')
xlabel('Time (s)')
ylabel('Nacelle Foreaft displacement (m) and Wind Speed (10*m/s)')

% plot Generator Torque
figure
plot(t,Gen_Torq/1e3)
hold on
plot(t,Rt_speed)
legend('Generator Torque (MN)','Rotor Speed (rpm)')
xlabel('Time (s)')
ylabel('Generator Torque (MN) and Rotor Speed (rpm)')
ylim([0 20])

% Trajectory plot of foreaft displacment and velocity (turbine coords?)
windowSize = 10; 
b = (1/windowSize)*ones(1,windowSize);
a = 1;
y = filter(b,a,Top_4aft_disp);
Top_4aft_v = gradient(y);

figure
plot(y,Top_4aft_v)
xlabel('Top Displacement (m)')
ylabel('Top Velocity (m/s)')

figure
plot(t,Cq)
hold on
plot(t,Ct/10)
legend('Cq','Ct/10')
xlabel('Time (s)')

figure
% plot(t,Pitch_1)
% hold on
plot(t,TSR)
% hold on
% plot(t,v_x)
%'Pitch'
legend('TSR')
xlabel('Time (s)')

figure
plot3(TSR,Pitch_1,Cq)
hold on
mesh(TSR_m,Pitch_m,Cq_1)
xlabel('TSR')
ylabel('Pitch')
zlabel('Cq')
zlim([-0.05 0.1])

figure
plot3(TSR,Pitch_1,Ct)
hold on
mesh(TSR_m,Pitch_m,Ct_1)
xlabel('TSR')
ylabel('Pitch')
zlabel('Ct')