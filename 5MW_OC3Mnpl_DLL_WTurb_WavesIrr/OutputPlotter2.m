%% Data analysis of openFAST outputs
clear all
close all
%16st tester with 15-240-RWT-Monopile

% 5 minute sim#
A = importdata('5MW_OC3Mnpl_DLL_WTurb_WavesIrr.out'); %this might take 5 mins lol4
%A = importdata('5MW_verify_extreme.out'); %this might take 5 mins lol4
 %IEA-15-240-RWT-Monopile.out' 
 %imported columns = A6:AAZ120009 (get 1:24? - A - (64 = BN)
 % Also want 64 and 65 - BM-BN 
 % And want 883 - 

t_start = 28.8*20;
t_end = 60*20;

t = A.data(1:(t_end-t_start+1),1);
% A = IEA15240RWTMonopile;
% A = A

Wind_x = A.data(t_start:t_end,2); %Wind speed (m/s)

Flap_x = A.data(t_start:t_end,5); %Flapwise Blade Tip Displacement (m)
Edge_x = A.data(t_start:t_end,6); %Edgewise Blade Tip Displacement (m)
Pitch_1 = A.data(t_start:t_end,7); %Blade Pitch Angle (deg)
Pitch_col = Pitch_1*2/3 +22/3;

Rt_speed = A.data(t_start:t_end,8)*2*pi/60; %Rotor Speed (rpm)
Gen_speed = A.data(t_start:t_end,9)*2*pi/60; %Gen Speed (rpm)

Top_4aft_disp = A.data(t_start:t_end,10); %Tower Foreaft Displacement (m)
Top_4aft_vel = A.data(t_start:t_end,11); %Tower Foreaft Velocity (m/s)

Rt_torq = A.data(t_start:t_end,12);
LSSgag = A.data(t_start:t_end,13);
Torsion_ang = A.data(t_start:t_end,17);
%Torsion_ang = A.data(t_start:t_end,17)*97;

Rt_thrust = A.data(t_start:t_end,15);
Rt_power = A.data(t_start:t_end,16);

Aero_thrust = A.data(t_start:t_end,18);
Aero_torq = A.data(t_start:t_end,19);
Cp = A.data(t_start:t_end,20);
Ct = A.data(t_start:t_end,21);
TSR = A.data(t_start:t_end,22);
Cq = Cp./TSR;

Rt_wind = A.data(t_start:t_end,23);
Rt_area = A.data(t_start:t_end,24);
% Aero_thrust = A.data(t_start:t_end,18);
% Aero_torq = A.data(t_start:t_end,19);
% Cp = A.data(t_start:t_end,20);
% Ct = A.data(t_start:t_end,21);
% TSR = A.data(t_start:t_end,22);
% Cq = Cp./TSR;
% 
% Rt_wind = A.data(t_start:t_end,23);
% Rt_area = A.data(t_start:t_end,24);

%Gen_torq = A.data(t_start:t_end,26);
%Torsion_ang_1 = A.data(t_start:t_end,17);
% Torsion_ang = LSStip - LSSgag;
% 
% for i = 1:length(Torsion_ang)
%     if Torsion_ang(i) < -359
%         Torsion_ang(i) = Torsion_ang(i) + 360;
%     end
%     
% end

% Approx aero torq and thrust
rho = 1.22521;
R = 61.5;
% 
% F_aero = 0.5*rho*Rt_area.*Rt_wind.^2.*Ct/1000;
% Tau_aero = 0.5*rho*Rt_area.*R.*Rt_wind.^2.*Cq/1000;

FAST = [Rt_speed,Gen_speed,Torsion_ang,Flap_x,Edge_x,Top_4aft_disp,Pitch_1,TSR,Cq,Ct,Aero_thrust,Aero_torq,Rt_wind,Rt_thrust,Rt_torq];
Rt_speed_2 = [1.27758101245985;1.27758101245985;1.27758101245985;1.27758101245985;1.27758101245985;1.27758101245985;1.27758101245985;1.27653381490865;1.27653381490865;1.27653381490865;1.27548661735746;1.27548661735746;1.27548661735746;1.27443941980626;1.27443941980626;1.27443941980626;1.27339222225506;1.27339222225506;1.27234502470387;1.27234502470387;1.27129782715267;1.27129782715267;1.27129782715267;1.27025062960147;1.27025062960147;1.26920343205028;1.26920343205028;1.26815623449908;1.26815623449908;1.26815623449908;1.26710903694788;1.26710903694788;1.26606183939669;1.26606183939669;1.26501464184549;1.26501464184549;1.26501464184549;1.26396744429429;1.26396744429429;1.26396744429429;1.26396744429429;1.26292024674310;1.26292024674310;1.26292024674310;1.26187304919190;1.26187304919190;1.26187304919190;1.26082585164070;1.26082585164070;1.26082585164070;1.26082585164070;1.25977865408951;1.25977865408951;1.25977865408951;1.25977865408951;1.25873145653831;1.25873145653831;1.25873145653831;1.25873145653831;1.25873145653831;1.25873145653831;1.25768425898711;1.25768425898711;1.25768425898711;1.25768425898711;1.25768425898711;1.25768425898711;1.25768425898711;1.25663706143592;1.25663706143592;1.25663706143592;1.25663706143592;1.25663706143592;1.25663706143592;1.25663706143592;1.25558986388472;1.25558986388472;1.25558986388472;1.25558986388472;1.25454266633352;1.25454266633352;1.25454266633352;1.25454266633352;1.25349546878233;1.25349546878233;1.25244827123113;1.25244827123113;1.25244827123113;1.25140107367993;1.25140107367993;1.25140107367993;1.25140107367993;1.25140107367993;1.25140107367993;1.25035387612874;1.25035387612874;1.25035387612874;1.25035387612874;1.25035387612874;1.25035387612874;1.25244827123113;1.25768425898711;1.27548661735746;1.31213853164934;1.34879044594122;1.36345121165797;1.36764000186276;1.37811197737472;1.39591433574506;1.41266949656421;1.43047185493455;1.45455739861207;1.48178453494319;1.50691727617190;1.53414441250302;1.56660753659011;1.59802346312601;1.62001461170114;1.63048658721310;1.64095856272507;1.65980811864661;1.68179926722174;1.69855442804088;1.71216799620644;1.73311194723037;1.76348067621507;1.79280220764858;1.81479335622370;1.83259571459405;1.84830367786199;1.86087004847635;1.87238922153952;1.88286119705148;1.89438037011465;1.90589954317781;1.91846591379217;1.93417387706012;1.95511782808405;1.97396738400559;1.98758095217114;1.99491133502952;2.00119452033670;2.00852490319507;2.01166649584866;2.01061929829747;2.00852490319507;2.00957210074627;2.01376089095106;2.01899687870704;2.02423286646302;2.02842165666781;2.02946885421901;2.02842165666781;2.02528006401422;2.01899687870704;2.00852490319507;1.99595853258072;1.98234496441516;1.97187298890319;1.96244821094242;1.95302343298165;1.94255145746969;1.93103228440653;1.92056030889456;1.90694674072900;1.88914438235866;1.86820043133473;1.84411488765721;1.82002934397969;1.79489660275097;1.77081105907345;1.74672551539593;1.72263997171840;1.70064882314327;1.67761047701695;1.65352493333943;1.62629779700832;1.59488187047242;1.56137154883413;1.52576683209344;1.49120931290396;1.45665179371447;1.42418866962737;1.39591433574506;1.37182879206754;1.35193203859481;1.33622407532686;1.32261050716130;1.31004413654694;1.29747776593258;1.28700579042062;1.27548661735746;1.26501464184549;1.25454266633352;1.24511788837275;1.23464591286079;1.22522113490002;1.21370196183686;1.20113559122250;1.18542762795455;1.16553087448181;1.14249252835549;1.11735978712677;1.08908545324446;1.05976392181096;1.02939519282626;1.00007366139275;0.972218206530921;0.947085465302203;0.925513195747553;0.907815557132331;0.893678390191177;0.882473376393373;0.873991076228680;0.867812610676621;0.862995501941116;0.858911431491449;0.855036800552022;0.851476328877954;0.848753615244843;0.846763939897569;0.844355385529817;0.842051550917184;0.839538276794312;0.834407008793449;0.825401109853158;0.812939458993919;0.797336215481090;0.778067780539072;0.755238873922986;0.730525011714747;0.704763951955310;0.678793452685635;0.654393749742754;0.634078117249540;0.618265434226471;0.606432101897950;0.598578120263975;0.594912928834787;0.594808209079668;0.596379005406462;0.598054521488377;0.599206438794693;0.599311158549813;0.597845081978138;0.594179890548950;0.588839183037847;0.582032398955069;0.573550098790377;0.563706441809129;0.552606147766445;0.540249216662325;0.526740368251889;0.512184322290256;0.496581078777427;0.479930637713401;0.462442438608418;0.445058959258554;0.428617957704767;0.413852472232895;0.401495541128776;0.392175482923126;0.386206456881305;0.383483743248194;0.383588463003314;0.385578138350587;0.388615011249057;0.391651884147528;0.393955718760160;0.395002916311357;0.394060438515280;0.389557489045134;0.381703507411160;0.371022092388955;0.357722683488758;0.341910000465689;0.324735960626065;0.307771360296680;0.291644518008253;0.276983752291500;0.264626821187380;0.255620922247090;0.249861335715508;0.247033902327277;0.246824462817038;0.248499978898953;0.250908533266705;0.253107648124218;0.254259565430534;0.253631246899816;0.251117972776944;0.246510303551679;0.239075200938183;0.229231543956935;0.218131249914251;0.206088478075490;0.193103228440653;0.180432138071174;0.169227124273370;0.159488187047242;0.151320046147908;0.145036860840729;0.141057510146182;0.138439516268190;0.136659280431156;0.135507363124840;0.134460165573643;0.132575209981489;0.129538337083019;0.125140107367993;0.119485240591532;0.112469016998515;0.104468427707373;0.0956196083997613;0.0863519100716715;0.0771575155721653;0.0684657758972336;0.0606117942632591;0.0538259541315051;0.0482548631591392;0.0439194652971853;0.0406417369619400;0.0379923271574126;0.0357827403243877;0.0338558968301860;0.0316463099971612;0.0288293485844423;0.0255097323471491;0.0216769893097696;0.0172473436682080;0.0124407069082156;0.00763825893842798;0.00310389354174672;-0.00104185684368550;-0.00459615005220187;-0.00733666604368336;-0.00921010246277408;-0.0102845271503018;-0.0106918869977173;-0.0104824474874779;-0.00979862748654656;-0.00891479275333664;-0.00804771318094585;-0.00729058935143071;-0.00676280178562763;-0.00661200533825532;-0.00688113510891284;-0.00749688726901644;-0.00838386359487996;-0.00944781630689571;-0.0105662232915737;-0.0116134208427703;-0.0125035387612874;-0.0131842171695652;-0.0136449840920917;-0.0138648955778430;-0.0138858395288669;-0.0137706477982353;-0.0135716802635079;-0.0133203528512207;-0.0130376095123976;-0.0128072260511344;-0.0126815623449908;-0.0126501464184549;-0.0127234502470387;-0.0129538337083019;-0.0133517687777566;-0.0138753675533549;-0.0144932141085609;-0.0151843644923507;-0.0159383467292122;-0.0167132729170977;-0.0174881991049832;-0.0182317093663328;-0.0189228597501225;-0.0195407063053285;-0.0200747770564388;-0.0205041280524294;-0.0207659274402285;-0.0208497032443243;-0.0207659274402285;-0.0205146000279413;-0.0201166649584866;-0.0196035381584003;-0.0190171075297302;-0.0185458686316917;-0.0181374615867251;-0.0178547182479020;-0.0177604704682943;-0.0178756621989259;-0.0181584055377490;-0.0185458686316917;-0.0190275795052422;-0.0195092903787926;-0.0198862814972234;-0.0201061929829747;-0.0201061929829747;-0.0198653375461995;-0.0193312667950892;-0.0184306769010601;-0.0173101755212798;-0.0160849543863797;-0.0147654854718720;-0.0134355445818523;-0.0123045712265600;-0.0114877571366267;-0.0109955742875643;-0.0108384946548848;-0.0110898220671720;-0.0117076686223780;-0.0125454266633352;-0.0134879044594122;-0.0144513262065130;-0.0153205001740062;-0.0159592906802362;-0.0163048658721310;-0.0163048658721310;-0.0159802346312601;-0.0153623880760541;-0.0145246300350968;-0.0136030961900438;-0.0126920343205028;-0.0119380520836412;-0.0114668131856027;-0.0113725654059951;-0.0117181405978899;-0.0125035387612874;-0.0136764000186276;-0.0151529485658148;-0.0168075206967054;-0.0184620928275960;-0.0199910012523430;-0.0212057504117311;-0.0220225645016644;-0.0223890836445833;-0.0222948358649756;-0.0217293491873294;-0.0208182873177884;-0.0197187298890319;-0.0185563406072037;-0.0174463112029353;-0.0165561932844182;-0.0160325945088199;-0.0158964588271644;-0.0161792021659874;-0.0168494085987533;-0.0178442462723900;-0.0190066355542182;-0.0201899687870704;-0.0212685822648029;-0.0220958683302482;-0.0225042753752149;-0.0223890836445833;-0.0218340689424491;-0.0208601752198362;-0.0194778744522567;-0.0178337742968781;-0.0161582582149635;-0.0145665179371447;-0.0131632732185412;-0.0120951317163207;-0.0114877571366267;-0.0113411494794592;-0.0116134208427703;-0.0122731553000241;-0.0132156330961011;-0.0143047185493455;-0.0153623880760541;-0.0162734499455951;-0.0169227124273370;-0.0172054557661601;-0.0170902640355285;-0.0165876092109541;-0.0157393791944849;-0.0146817096677763;-0.0135193203859481;-0.0123988190061677;-0.0114563412100908;-0.0108280226793728;-0.0105871672425976;-0.0107756628018130;-0.0114144533080429;-0.0124407069082156;-0.0137706477982353;-0.0152681402964464;-0.0168075206967054;-0.0182526533173567;-0.0194569305012328;-0.0202946885421901;-0.0208078153422764;-0.0208706471953482;-0.0204936560769174;-0.0198025056931277;-0.0189333317256345;-0.0179803819540456;-0.0170274321824567;-0.0162525059945712;-0.0157812670965327;-0.0156346594393652;-0.0158231549985806;-0.0163572257496909;-0.0171845118151362;-0.0181793494887729;-0.0192160750644576;-0.0202004407625824;-0.0210067828770038;-0.0215199096770901;-0.0216665173342576;-0.0214466058485063;-0.0208392312688123;-0.0198967534727354;-0.0187134202398832;-0.0174044233008875;-0.0160744824108678;-0.0148492612759678;-0.0138230076757951;-0.0130899693899575;-0.0126920343205028;-0.0126292024674310;-0.0128805298797182;-0.0133831847042925;-0.0140533911370583;-0.0147654854718720;-0.0154461638801498;-0.0159697626557481;-0.0162734499455951;-0.0163153378476430;-0.0160640104353558;-0.0155613556107814;-0.0148178453494319;-0.0139486713819387;-0.0130480814879096;-0.0122103234469523;-0.0115087010876506;-0.0110479341651241;-0.0108803825569327;-0.0110269902141002;-0.0114877571366267;-0.0122417393734882;-0.0132051611205891;-0.0142837745983216;-0.0154042759781020;-0.0164514735292986;-0.0173520634233276;-0.0180117978805815;-0.0184097329500362;-0.0185144527051558;-0.0183992609745242;-0.0180432138071174;-0.0174567831784473;-0.0168494085987533;-0.0163258098231550;-0.0158650429006285;-0.0155299396842455;-0.0154461638801498;-0.0156346594393652;-0.0160221225333079;-0.0165771372354421;-0.0172997035457678;-0.0180851017091652;-0.0188076680194909;-0.0194045706236730;-0.0198339216196636;-0.0200433611299029;-0.0199491133502952;-0.0195721222318644;-0.0189647476521704;-0.0181898214642849;-0.0172787595947439;-0.0163048658721310;-0.0154042759781020;-0.0146293497902165;-0.0140219752105224;-0.0136240401410677;-0.0134564885328763;-0.0135193203859481;-0.0137497038472113;-0.0141057510146182;-0.0145246300350968;-0.0149330370800635;-0.0152471963454225;-0.0154356919046379;-0.0154356919046379;-0.0152471963454225;-0.0148702052269917;-0.0143361344758814;-0.0136868719941395;-0.0129852496348378;-0.0123255151775840;-0.0117495565244258;-0.0113306775039472;-0.0111107660181959;-0.0111107660181959;-0.0113516214549711;-0.0117914444264737;-0.0124092909816797;-0.0131632732185412;-0.0139486713819387;-0.0147340695453361;-0.0154356919046379;-0.0160116505577960;-0.0163991136517387;-0.0165980811864661;-0.0166085531619780;-0.0164619455048105;-0.0161687301904755;-0.0158231549985806;-0.0154671078311737;-0.0151634205413267;-0.0149644530065994;-0.0149120931290396;-0.0150272848596712;-0.0153100281984943;-0.0157289072189729;-0.0162943938966191;-0.0169017684763131;-0.0174777271294712;-0.0179908539295576;-0.0184097329500362;-0.0186401164112994;-0.0186610603623234;-0.0184830367786199;-0.0181165176357011;-0.0175824468845909;-0.0169227124273370;-0.0162210900680353;-0.0155299396842455;-0.0148911491780156;-0.0143570784269054;-0.0139800873084746;-0.0137811197737472;-0.0137392318716994;-0.0138230076757951;-0.0140219752105224;-0.0142837745983216;-0.0145351020106088;-0.0147340695453361;-0.0148387893004558;-0.0148283173249438;-0.0146607657167524;-0.0143466064513934;-0.0139172554554028;-0.0134146006308284;-0.0128491139531823;-0.0123045712265600;-0.0118333323285216;-0.0114563412100908;-0.0112259577488275;-0.0111526539202438;-0.0112678456508754;-0.0115401170141865;-0.0119275801081292;-0.0124302349327036;-0.0129852496348378;-0.0135297923614600;-0.0140324471860344;-0.0144513262065130;-0.0147654854718720;-0.0149539810310874;-0.0150063409086472;-0.0149539810310874;-0.0148283173249438;-0.0146502937412404;-0.0144617981820250;-0.0143256625003695;-0.0142523586717857;-0.0142837745983216;-0.0144199102799772;-0.0146712376922643;-0.0150168128841592;-0.0154252199291259;-0.0158755148761404;-0.0163153378476430;-0.0167132729170977;-0.0170483761334806;-0.0172263997171840;-0.0172578156437199;-0.0171949837906481;-0.0169960162559208;-0.0166504410640259;-0.0162210900680353;-0.0157707951210208;-0.0153309721495182;-0.0148911491780156;-0.0145141580595848;-0.0142523586717857;-0.0140848070635942;-0.0140010312594985;-0.0140010312594985;-0.0140638631125703;-0.0141581108921780;-0.0142418866962737;-0.0142942465738336;-0.0142837745983216;-0.0141999987942259;-0.0140115032350105;-0.0137392318716994;-0.0134041286553165;-0.0130166655613737;-0.0126187304919190;-0.0122312673979763];
Pitch_2 = [3.70300000000000;3.70400000000000;3.70600000000000;3.70900000000000;3.71400000000000;3.71900000000000;3.72600000000000;3.73300000000000;3.73900000000000;3.74300000000000;3.74600000000000;3.74800000000000;3.74700000000000;3.74600000000000;3.74400000000000;3.74300000000000;3.74100000000000;3.73900000000000;3.73800000000000;3.73500000000000;3.73000000000000;3.72300000000000;3.71400000000000;3.70400000000000;3.69300000000000;3.68200000000000;3.67100000000000;3.66000000000000;3.64800000000000;3.63600000000000;3.62400000000000;3.61000000000000;3.59500000000000;3.57800000000000;3.56100000000000;3.54300000000000;3.52500000000000;3.50800000000000;3.49000000000000;3.47400000000000;3.45700000000000;3.44100000000000;3.42400000000000;3.40700000000000;3.38900000000000;3.37000000000000;3.35100000000000;3.33100000000000;3.31200000000000;3.29200000000000;3.27300000000000;3.25400000000000;3.23400000000000;3.21400000000000;3.19300000000000;3.17100000000000;3.14900000000000;3.12800000000000;3.10700000000000;3.08600000000000;3.06600000000000;3.04600000000000;3.02600000000000;3.00600000000000;2.98600000000000;2.96500000000000;2.94400000000000;2.92300000000000;2.90300000000000;2.88300000000000;2.86400000000000;2.84400000000000;2.82500000000000;2.80600000000000;2.78600000000000;2.76500000000000;2.74400000000000;2.72100000000000;2.69800000000000;2.67500000000000;2.65100000000000;2.62700000000000;2.60200000000000;2.57700000000000;2.55100000000000;2.52300000000000;2.49300000000000;2.46100000000000;2.42800000000000;2.39400000000000;2.36100000000000;2.32800000000000;2.29700000000000;2.26600000000000;2.23600000000000;2.20500000000000;2.17300000000000;2.14000000000000;2.10500000000000;2.07000000000000;2.03600000000000;2.00800000000000;2.40800000000000;2.80800000000000;3.20800000000000;3.60800000000000;4.00800000000000;4.40800000000000;4.80800000000000;5.20800000000000;5.60800000000000;6.00800000000000;6.40800000000000;6.80800000000000;7.20800000000000;7.60800000000000;8.00800000000000;8.40800000000000;8.80800000000000;9.20800000000000;9.60800000000000;10.0100000000000;10.4100000000000;10.8100000000000;11.2100000000000;11.6100000000000;12.0100000000000;12.4100000000000;12.8100000000000;13.2100000000000;13.6100000000000;14.0100000000000;14.4100000000000;14.8100000000000;15.2100000000000;15.6100000000000;16.0100000000000;16.4100000000000;16.8100000000000;17.2100000000000;17.6100000000000;18.0100000000000;18.4100000000000;18.8100000000000;19.2100000000000;19.6100000000000;20.0100000000000;20.4100000000000;20.8100000000000;21.2100000000000;21.6100000000000;22.0100000000000;22.4100000000000;22.8100000000000;23.2100000000000;23.6100000000000;24.0100000000000;24.4100000000000;24.8100000000000;25.2100000000000;25.6100000000000;26.0100000000000;26.4100000000000;26.8100000000000;27.2100000000000;27.6100000000000;28.0100000000000;28.4100000000000;28.8100000000000;29.2100000000000;29.6100000000000;30.0100000000000;30.4100000000000;30.8100000000000;31.2100000000000;31.6100000000000;32.0100000000000;32.4100000000000;32.8100000000000;33.2100000000000;33.6100000000000;34.0100000000000;34.4100000000000;34.8100000000000;35.2100000000000;35.6100000000000;36.0100000000000;36.4100000000000;36.8100000000000;37.2100000000000;37.6100000000000;38.0100000000000;38.4100000000000;38.8100000000000;39.2100000000000;39.6100000000000;40.0100000000000;40.4100000000000;40.8100000000000;41.2100000000000;41.6100000000000;42.0100000000000;42.4100000000000;42.8100000000000;43.2100000000000;43.6100000000000;44.0100000000000;44.4100000000000;44.8100000000000;45.2100000000000;45.6100000000000;46.0100000000000;46.4100000000000;46.8100000000000;47.2100000000000;47.6100000000000;48.0100000000000;48.4100000000000;48.8100000000000;49.2100000000000;49.6100000000000;50.0100000000000;50.4100000000000;50.8100000000000;51.2100000000000;51.6100000000000;52.0100000000000;52.4100000000000;52.8100000000000;53.2100000000000;53.6100000000000;54.0100000000000;54.4100000000000;54.8100000000000;55.2100000000000;55.6100000000000;56.0100000000000;56.4100000000000;56.8100000000000;57.2100000000000;57.6100000000000;58.0100000000000;58.4100000000000;58.8100000000000;59.2100000000000;59.6100000000000;60.0100000000000;60.4100000000000;60.8100000000000;61.2100000000000;61.6100000000000;62.0100000000000;62.4100000000000;62.8100000000000;63.2100000000000;63.6100000000000;64.0100000000000;64.4100000000000;64.8100000000000;65.2100000000000;65.6100000000000;66.0100000000000;66.4100000000000;66.8100000000000;67.2100000000000;67.6100000000000;68.0100000000000;68.4100000000000;68.8100000000000;69.2100000000000;69.6100000000000;70.0100000000000;70.4100000000000;70.8100000000000;71.2100000000000;71.6100000000000;72.0100000000000;72.4100000000000;72.8100000000000;73.2100000000000;73.6100000000000;74.0100000000000;74.4100000000000;74.8100000000000;75.2100000000000;75.6100000000000;76.0100000000000;76.4100000000000;76.8100000000000;77.2100000000000;77.6100000000000;78.0100000000000;78.4100000000000;78.8100000000000;79.2100000000000;79.6100000000000;80.0100000000000;80.4100000000000;80.8100000000000;81.2100000000000;81.6100000000000;82.0100000000000;82.4100000000000;82.8100000000000;83.2100000000000;83.6100000000000;84.0100000000000;84.4100000000000;84.8100000000000;85.2100000000000;85.6100000000000;86.0100000000000;86.4100000000000;86.8100000000000;87.2100000000000;87.6100000000000;88.0100000000000;88.4100000000000;88.8100000000000;89.2100000000000;89.6100000000000;90.0100000000000;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90;90];

Rt_speed_2 = Rt_speed_2(80:701);
Pitch_2 = Pitch_2(80:701);
%g_x0 = ((Rt_speed-1.26).^2/(0.48^2) + (Pitch_1-23).^2/(11^2)) +  + (Torsion_ang).^2/(0.1^2)+ (Top_4aft_disp-0.2).^2/((0.4)^2) + (Top_4aft_vel).^2/((0.8)^2); % = 1


g_x0 = @(x1,x2)((x1-1.26).^2/(0.48^2) + (x1*97 - 1.26*97).^2/(45^2) + (x2-23).^2/(11^2) -1 ); % = 1

%g_x0_plot2 = @(x1,x4) g_x0_plot(x1,97*x1,0,0.2,0,90-x4,-8);

%plot(Rt_speed_2,Pitch_2,'r')
hold on
plot(Rt_speed,Pitch_1,'b')
hold on
fimplicit(g_x0,'g') %1 - operation region
hold on
x_u_1 = nsidedpoly(4, 'Center', [2.01+100 0], 'Sidelength', 200);
%plot(x_u_1, 'FaceColor', 'r')
plot([2.01 2.01],[0 120],'r')

hold on
%plot(Rt_speed_2(1),Pitch_2(1),'mo')
hold on
%plot(Rt_speed_2(701-80),Pitch_2(701-80),'mx')

hold on
plot(Rt_speed(1),Pitch_1(1),'mo')
hold on
%plot(Rt_speed(1201-80),Pitch_1(1201-80),'mx')

xlabel('Rotor Speed (rad/s)')
ylabel('Pitch (deg)')
legend('OpenFAST Trajectory','Operation Region','Unsafe Region')
xlim([0 2.5])
ylim([0 55])

% 1 - Plot power output and wind speed
figure
plot(t,Wind_x)
hold on
%plot(t,Rt_wind)
xlabel('Time (s)','fontsize',16)
title('Wind Speed (m/s)','fontsize',18)
%xlim([270 300])
%ylim([15 40])
% 2- Plot rotor speed and thrust
figure
plot(t,Rt_speed)
xlabel('Time (s)','fontsize',16)
title('Rotor Speed (rad/s)','fontsize',18)
%ylim([1 1.5])
%xlim([270 300])
% 3 - Plot pitch angle and rotor speed
figure
plot(t,Pitch_1)
% hold on
% plot(t,Rt_speed)
%legend('Blade Pitch (deg)','Rotor Speed (rpm)')
xlabel('Time (s)','fontsize',16)
title('Blade Pitch (deg)','fontsize',18)
%ylim([10 35])
%xlim([270 300])


% 4 - plot foreaft !
figure
plot(t,Top_4aft_disp)
xlabel('Time (s)','fontsize',16')
title('Tower Top Foreaft Displacement (m)','fontsize',18)

% 5 - plot and rotor thrust
figure
%plot(t,Rt_thrust/1e3)
hold on
plot(t,Aero_thrust/1e6)
%legend('Rotor Thrust (MN)','Aerodynamic Thrust (MN)')
title('Rotor Thrust (MN)','fontsize',18)
xlabel('Time (s)','fontsize',16)


% 6 - plot Generator Torque
figure
%plot(t,Rt_torq/1e3)
hold on
plot(t,Aero_torq/1e6)
xlabel('Time (s)','fontsize',16)
title('Rotor Torque (MNm)','fontsize',18)
%legend('Rotor Torque (MNm)','Aerodynamic Torque (MNm)')

% % Trajectory plot of foreaft displacment and velocity (turbine coords?)
% windowSize = 10; 
% b = (1/windowSize)*ones(1,windowSize);
% a = 1;
% y = filter(b,a,Top_4aft_disp);
% Top_4aft_v = gradient(y);

figure
plot(t,Top_4aft_vel)
xlabel('Time (s)')
ylabel('Top Velocity (m/s)')

% % 7-
% figure
% plot(t,Cq)
% ylabel('Torque Coefficient')
% xlabel('Time (s)')
% % 
% 
% %8
% figure
% plot(t,Ct)
% ylabel('Thrust Coefficient')
% xlabel('Time (s)')
% % 
% 
% % 9
% figure
% % plot(t,Pitch_1)
% % hold on
% plot(t,TSR)
% % hold on
% % plot(t,v_x)
% %'Pitch'
% ylabel('TSR')
% xlabel('Time (s)')

% %10 flapwise
% figure
% plot(t,Flap_x)
% xlabel('Time (s)','fontsize',16)
% title('Flapwise Blade Tip Displacement (m)','fontsize',18)
% 
% 
% %11 - edgewise
% figure
% plot(t,Edge_x)
% xlabel('Time (s)','fontsize',16)
% title('Edgewise Blade Tip Displacement (m)','fontsize',18)


%12 - Genspeed
figure
plot(t,Gen_speed)
xlabel('Time (s)','fontsize',16)
title('Generator Speed (rpm)','fontsize',18)

%13 - Torsion Angle
figure
plot(t,Torsion_ang)
xlabel('Time (s)','fontsize',16)
title('Torsion Angle (rad)','fontsize',18)
%For complex model!
g_x0 = ((Rt_speed-1.26).^2/(0.48^2) + (Pitch_1-23).^2/(11^2)) + (Gen_speed - 1.26*97).^2/(45^2) + (Torsion_ang).^2/(0.1^2)+ (Top_4aft_disp-0.2).^2/((0.4)^2) + (Top_4aft_vel).^2/((0.8)^2); % = 1

%Pitch_1(874*20:894*20) = Pitch_1(874*20:894*20)+-2;

r_35 = 1.8^0.5;
r_21 = 9^0.5;
dif = r_21-r_35;
xv_wind = movmean(Wind_x,[20*600 0]);


g_x0_wind = ((Rt_speed-1.26).^2/(0.163^2) + (Pitch_1-25).^2/(5^2))./((r_35+dif*2.5 - 1.12*xv_wind*dif/14).^2); % = 1


g_x0_fault = ((Rt_speed-1.26).^2/(0.3^2) + (Pitch_1-23).^2/(9.5^2));

figure

plot(t,g_x0)
hold on
%plot(t,g_x0_wind)
% hold on
% plot(t,g_x0_fault)
plot(t,ones(1,length(t)),'r')
%ylim([0 1.1])
xlabel('Time (s)')
ylabel('Supervisory Safety System Level')
%legend('Extreme Wind Supervisor','Actuator Fault Supervisor')

figure 
plot(t,Wind_x)
hold on
plot(t,xv_wind)
xlabel('Time (s)')
ylabel('Wind Speed (m/s)')
legend('Wind Speed','Averaged Wind Speed')
% figure
% plot3(TSR,Pitch_1,Cq)
% hold on
% mesh(TSR_m,Pitch_m,Cq_1)
% xlabel('TSR')
% ylabel('Pitch')
% zlabel('Cq')
% zlim([-0.05 0.1])
% 
% figure
% plot3(TSR,Pitch_1,Ct)
% hold on
% mesh(TSR_m,Pitch_m,Ct_1)
% xlabel('TSR')
% ylabel('Pitch')
% zlabel('Ct')